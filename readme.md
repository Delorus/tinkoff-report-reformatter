# Сводка

Утилита для генерации сводного отчета в формате CSV/XLSX из брокерского отчета, 
который можно получить в Тинькофф Инвестиции (в формате XLSX).

# Формат сводного отчета

## Сводка по операциям по дням

Для каждой валюты своя отдельная таблица, в конце приводится суммарный итог.

| Дата исполнения | Операция        | Сумма зачисления | Сумма списания |
| --------------- | --------------- | ---------------- | -------------- |
|      01.02.2020 | Покупка/продажа |               0p |            50p |
|      01.02.2020 | Покупка/продажа |             100p |             0p |
| Итого           |                 |             100p |            50p |
|                 |                 |                  |           +50p |


## Детальный отчет по каждому инструменту

| Инструмент | Продажа | Покупка | Комиссия | Результат | Частично | 
| ---------- | ------- | ------- | -------- | --------- | -------- |
|     Лукойл |    100р |     50р |       1p |       49p |       Да |
|        ММК |     50p |     50p |       1p |       -1p |      Нет |
| Итого:     |    150p |    100p |       2p |       48p |          |


## Отчет по активам на конец периода

| Название            | Средняя | Количество | Стоимость | Валюта |
| ------------------- | ------- | ---------- | --------- | ------ |
|                 RUB |       1 |        100 |       100 |    RUB |
|            Сбербанк |  230.76 |         30 |    6922.8 |    RUB |
|                 ММК |   44.21 |         50 |    2210.5 |    USD |
| Итоговая стоимость: |         |            |    7022.8 |    RUB |
|                     |         |            |    2210.5 |    USD |

# TODO

* [x] Форматирование в CSV
* [ ] Форматирование в Excel
* [ ] Сводка по операциям по дням
* [x] Детальный отчет по каждому инструменту
* [ ] Отчет по активам на конец периода